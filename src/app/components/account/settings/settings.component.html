<div class="settings-container">
  <h1 class="settings-container__header">Settings</h1>
  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="settings-container__form">

    <mat-form-field appearance="outline" class="settings-container__form__field">
      <mat-label>Email</mat-label>
      <input matInput formControlName="email"/>
    </mat-form-field>

    <h1>Broker access tokens</h1>
    <mat-list>
      <mat-list-item *ngIf="broker.isBrokerToken">
        <p mat-line>Broker name:
          <span class="settings-container__form__broker-name">
            {{broker.brokerName}}
          </span>
        </p>
        <mat-checkbox [(ngModel)]="isDemoValue"
          (ngModelChange)="onIsDemoCheckboxChanged($event)"
          [ngModelOptions]="{standalone: true}"
          [matTooltip]="checkboxTooltipText"
          matTooltipPosition="above"
          style="margin-right: 2rem;">
          Demo Token
        </mat-checkbox>
        <button mat-raised-button color="primary" (click)="onTokenValidation(broker)" type="button" style="margin-right: 2rem;">
          Validate token
        </button>
        <button mat-raised-button color="warn" (click)="onRemoveToken(broker)" type="button">
          Remove
        </button>
      </mat-list-item>
      <mat-form-field *ngIf="!broker.isBrokerToken" appearance="outline">
        <mat-label>Token for {{broker.text}}</mat-label>
        <input matInput [type]="hide ? 'password' : 'text'" formControlName="tinkoffToken" />
        <mat-icon matSuffix (click)="hide = !hide">{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
      </mat-form-field>
      <mat-divider></mat-divider>
    </mat-list>

    <div>
      <button class="settings-container__form__btn-save" mat-raised-button color="accent" type="submit"
        [disabled]="!canSave">
        Save changes
      </button>
    </div>
  </form>
</div>

<mat-spinner *ngIf="loading" class="loading"></mat-spinner>
